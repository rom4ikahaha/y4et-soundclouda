__В этой лабораторной работе проектируется ИС, которая собирает и анализирует метрики прослушиваний треков рэп артистов на SoundCloud, чтобы быстро видеть динамику, сравнивать релизы и готовить отчёты.__

## **Предметная область**: 
- Показать на практическом примере, как спроектировать ИС: определить предметную область, роли и функции, а затем описать процессы в виде Use Case и блок схем, плюс наметить структуру БД и архитектуру.

## **Цели системы**:

- Централизованно собирать и хранить метрики по трекам и артистам.

- Быстро строить отчёты “топ N”, видеть тренды и пики, сравнивать релизы.

- Экспортировать результаты в CSV/XLSX/PNG и присылать уведомления о всплесках

## **Пользователи и роли**:

- Администратор: ведёт справочники артистов и треков, настраивает расписание сбора, управляет пользователями/ролями, словарями жанров/тегов.

- Аналитик/Менеджер: смотрит дашборды, формирует отчёты, сравнивает треки/артистов, настраивает фильтры и экспорт.

## **Основные функции**:

- Регистрация артистов и треков с валидацией ссылок SoundCloud.

- Плановый сбор метрик по расписанию, хранение фактов и пересчёт суточных агрегатов.

- Отчёты: топ N, сравнения, приросты, коэффициент вовлечённости, фильтры по периодам/жанрам/артистам, экспорт CSV/XLSX/PNG.

- Уведомления о всплесках и аномалиях.

## **Требования и ограничения**: 

- уникальность ссылок треков; целостность связей; индексы по времени и идентификаторам; в рамках лабораторной допускается работа на тестовых данных без реальных интеграций, с имитацией источника.

## **Архитектура**:

- Базовая схема: трёхслойная архитектура с отдельными фоновыми задачами (ETL)

- **Presentation (Web UI)** : интерфейс аналитика для дашбордов, топ N, сравнений, экспорта.

- **Business Logic (API)** : агрегирующие запросы, расчёт метрик, валидация, RBAC.

- **Data/Repository** : реляционная БД для справочников, фактов и суточных агрегатов.

- **ETL по расписанию** : инкрементальная загрузка метрик, нормализация, пересчёт агрегатов, аудит JobRun

## **Компоненты системы**: 

- Веб клиент аналитика: страницы “Дашборд”, “Топ N”, “Сравнение”, “Отчёты”, формы экспорта CSV/XLSX/PNG, фильтры по периоду/артистам/жанрам; авторизация по ролям.

- Backend API: REST/GraphQL эндпоинты для агрегатов и сравнений, сервис отчётов, модуль уведомлений, эндпоинты статусов ETL и ручного перезапуска задач (для демонстрации).

- ETL сервис: периодический сбор метрик (имитация или реальный HTTP клиент), запись в MetricFact, пересчёт DailyAggregate, логирование в JobRun, обработка ретраев и throttling.

- Хранилище данных: PostgreSQL со схемой Artist, Track, MetricFact, DailyAggregate, JobRun, User; уникальности и индексы по времени/идентификаторам.

## **Схема данных**:

| <!-- -->      | <!-- -->        | <!-- -->      | <!-- -->      | <!-- -->      | <!-- -->      | 
|:------------- |:---------------:| :-------------:| :-------------:|  :-------------:| :-------------:|
| Artist         | id        | name      |  url  |  
| Track         | id         | artistId        | title   |  release_date | 
| Metric         | id         | trackId        | ts  |  listens |  likes |
| User         | id       | login       | role  | 


## **Технологии и иструменты**:

- **Backend**: Python или Node.js.

- **Frontend**: React + ECharts; таблицы — AG Grid.

- **БД**: PostgreSQL; миграции — Python или Node.

- **ETL**: cron/systemd timer.

- **Экспорт**: CSV/XLSX/PNG; логирование — структурированные JSON логи, хранение JobRun в БД.


## **План реализации**

- **Этап 1:** Справочники Artist/Track, CRUD, валидация URL; БД и миграции.

- **Этап 2:** Таблицы MetricFact/DailyAggregate, индексы и уникальные ключи; генерация тестовых данных/имитация загрузки.

- **Этап 3:** ETL скрипт по расписанию, ретраи, throttling, журнал JobRun.

- **Этап 4:** Дашборды, отчёты Top N и сравнения; экспорт CSV/XLSX/PNG.

- **Этап 5:** Уведомления (пороговые правила), RBAC (Admin/Analyst), подготовка презентации

