@startuml

start

:Планировщик (cron/systemd) запускает ETL;

:Загрузка конфигурации источников/трейков;

if (Доступен источник?) then (да)

:Получить метрики по треку;

:Валидировать и нормализовать;

:Записать Metric;\nПересчитать DailyAggregate;

else (нет)

:Логировать ошибку;\nувеличить error_num;

endif

:Обновить JobRun (status);

stop

@enduml.
